package org.openrewrite.java.dependencies.nvd.api;

import lombok.Value;

import java.util.List;
import java.util.stream.Collectors;

@Value
public class Vulnerability {
    String id;
    List<Description> descriptions;
    Metrics metrics;
    List<Weakness> weaknesses;
    List<Configuration> configurations;

    public String getDescription() {
        return Description.getDescription(descriptions);
    }

    public double getBaseScore() {
        return metrics.getCvssMetricV31().getCvssData().getBaseScore();
    }

    public List<String> getWeaknesses() {
        return weaknesses.stream()
                .map(w -> Description.getDescription(w.getDescriptions()))
                .collect(Collectors.toList());
    }
}
